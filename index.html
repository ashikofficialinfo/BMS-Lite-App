<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>BMS-Lite Control</title>

<link rel="stylesheet" href="styles.css">
<script type="module" src="app.js"></script>
</head>

<body>

<div class="card">

  <h1>BMS-Lite Control</h1>
  <div id="statusBadge" class="status-badge offline">Offline</div>

  <!-- Login UI -->
  <div id="authBox">
    <input id="emailField" type="email" placeholder="Email" />
    <input id="passwordField" type="password" placeholder="Password" />
    <button id="loginBtn" class="btn login-btn">Login</button>
    <p id="authMsg"></p>
  </div>

  <!-- Control UI -->
  <div id="controlBox" style="display:none;">

    <!-- Temperature Display -->
    <div class="temperature-display">
      <h2>Temperature: <span id="temp">--</span> Â°C</h2>
    </div>

    <button id="gpio1Btn" class="gpio-button" data-gpio="gpio1">BMS-Lite GPIO 1</button>
    <div id="gpio1Status" class="gpio-status">Status: OFF</div>

    <button id="gpio2Btn" class="gpio-button" data-gpio="gpio2">BMS-Lite GPIO 2</button>
    <div id="gpio2Status" class="gpio-status">Status: OFF</div>

    <button id="gpio3Btn" class="gpio-button" data-gpio="gpio3">BMS-Lite GPIO 3</button>
    <div id="gpio3Status" class="gpio-status">Status: OFF</div>

    <button id="logoutBtn" class="btn logout-btn">Logout</button>
  </div>

</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
  import { getDatabase, ref, onValue, set } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-database.js";

  // Firebase config
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    databaseURL: "YOUR_DATABASE_URL",
    projectId: "YOUR_PROJECT_ID",
  };

  // Initialize Firebase
  const app = initializeApp(firebaseConfig);
  const db = getDatabase(app);

  // Temperature real-time listener
  const tempRef = ref(db, 'temperature');
  onValue(tempRef, (snapshot) => {
    const temp = snapshot.val();
    document.getElementById('temp').innerText = temp;
  });

  // GPIO real-time listeners
  ['gpio1','gpio2','gpio3'].forEach(gpio => {
    const gpioRef = ref(db, gpio);
    onValue(gpioRef, (snapshot) => {
      const val = snapshot.val();
      document.getElementById(gpio + 'Status').innerText = "Status: " + (val ? "ON" : "OFF");
    });
  });

</script>

</body>
</html>
